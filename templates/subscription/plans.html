{% extends "layout.html" %}

{% block title %}Üyelik Planları - MediTahlil{% endblock %}

{% block extra_css %}
<style>
    .pricing-card {
        transition: transform 0.3s, box-shadow 0.3s;
        height: 100%;
    }
    
    .pricing-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }
    
    .pricing-header {
        padding: 2rem 0;
        border-radius: 10px 10px 0 0;
    }
    
    .pricing-card.free .pricing-header {
        background-color: #f8f9fa;
    }
    
    .pricing-card.basic .pricing-header {
        background-color: #b9deff;
    }
    
    .pricing-card.premium .pricing-header {
        background-color: #ffcd56;
    }
    
    .pricing-card.family .pricing-header {
        background-color: #a6dfff;
    }
    
    .pricing-price {
        font-size: 3rem;
        font-weight: bold;
    }
    
    .pricing-period {
        font-size: 1rem;
        color: #6c757d;
    }
    
    .pricing-features {
        padding: 0;
        list-style-type: none;
    }
    
    .pricing-features li {
        padding: 0.75rem 0;
        border-bottom: 1px solid #eee;
    }
    
    .pricing-features li:last-child {
        border-bottom: none;
    }
    
    .pricing-btn {
        padding: 0.75rem 2rem;
        border-radius: 50px;
    }
    
    .badge-popular {
        position: absolute;
        top: 10px;
        right: 10px;
        transform: rotate(15deg);
    }
    
    .pricing-description {
        min-height: 50px;
    }
    
    [data-bs-theme="dark"] .pricing-card.free .pricing-header {
        background-color: #343a40;
    }
    
    [data-bs-theme="dark"] .pricing-card.basic .pricing-header {
        background-color: #0d6efd50;
    }
    
    [data-bs-theme="dark"] .pricing-card.premium .pricing-header {
        background-color: #ffc10770;
    }
    
    [data-bs-theme="dark"] .pricing-card.family .pricing-header {
        background-color: #0dcaf050;
    }
    
    .feature-check {
        color: #198754;
    }
    
    .feature-unavailable {
        color: #dc3545;
        opacity: 0.5;
    }
    
    .payment-methods {
        max-width: 500px;
        margin: 0 auto;
    }
    
    .payment-methods img {
        height: 40px;
        margin: 0 10px;
        filter: grayscale(0.5);
        transition: filter 0.3s;
    }
    
    .payment-methods img:hover {
        filter: grayscale(0);
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Header -->
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold">Üyelik Planları</h1>
        <p class="lead text-muted">Size en uygun planı seçin ve tahlil analizlerine hemen başlayın</p>
    </div>
    
    <!-- Pricing Cards -->
    <div class="row g-4 mb-5">
        {% for plan_id, plan in plans.items() %}
        <div class="col-md-6 col-lg-3">
            <div class="card pricing-card h-100 border-0 shadow-sm {{ plan_id }}">
                {% if plan_id == 'premium' %}
                <span class="badge bg-danger badge-popular p-2">En Popüler</span>
                {% endif %}
                
                <div class="pricing-header text-center py-4">
                    <h4 class="my-0 fw-bold">{{ plan.name }}</h4>
                </div>
                
                <div class="card-body text-center">
                    <div class="pricing-price mb-3">
                        {% if plan.price == 0 %}
                            Ücretsiz
                        {% else %}
                            {{ "%.2f"|format(plan.price) }} ₺
                            <span class="pricing-period">/ay</span>
                        {% endif %}
                    </div>
                    <p class="pricing-description text-muted mb-4">{{ plan.description }}</p>
                    
                    <ul class="pricing-features text-start">
                        {% for feature in plan.features %}
                        <li>
                            <i class="fas fa-check me-2 feature-check"></i>
                            {{ feature }}
                        </li>
                        {% endfor %}
                        
                        {% if plan_id == 'free' %}
                        <li>
                            <i class="fas fa-times me-2 feature-unavailable"></i>
                            <span class="text-muted">PDF rapor indirme</span>
                        </li>
                        <li>
                            <i class="fas fa-times me-2 feature-unavailable"></i>
                            <span class="text-muted">E-posta bildirim</span>
                        </li>
                        <li>
                            <i class="fas fa-times me-2 feature-unavailable"></i>
                            <span class="text-muted">Öncelikli destek</span>
                        </li>
                        {% endif %}
                    </ul>
                </div>
                
                <div class="card-footer bg-transparent border-0 text-center pb-4">
                    {% if user_plan and user_plan == plan_id %}
                        <div class="d-grid">
                            <button class="btn btn-success pricing-btn" disabled>
                                <i class="fas fa-check me-2"></i>Aktif Plan
                            </button>
                        </div>
                    {% else %}
                        <div class="d-grid">
                            {% if plan_id == 'free' %}
                                {% if user_plan and user_plan != 'free' %}
                                <a href="{{ url_for('subscription_cancel') }}" 
                                   class="btn btn-outline-secondary pricing-btn"
                                   onclick="return confirm('Premium üyeliğinizi iptal etmek istediğinize emin misiniz?');">
                                    Ücretsiz Plana Geç
                                </a>
                                {% else %}
                                <button class="btn btn-outline-secondary pricing-btn" disabled>
                                    Aktif Plan
                                </button>
                                {% endif %}
                            {% else %}
                                <a href="{{ url_for('subscription_checkout', plan_id=plan_id) }}" 
                                   class="btn {% if plan_id == 'premium' %}btn-warning{% else %}btn-primary{% endif %} pricing-btn">
                                    {% if user_plan == 'free' %}
                                        Hemen Başla
                                    {% else %}
                                        Planı Değiştir
                                    {% endif %}
                                </a>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <!-- Payment Methods -->
    <div class="text-center mb-5">
        <h4 class="mb-4">Güvenli Ödeme Yöntemleri</h4>
        <div class="payment-methods">
            <img src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png" alt="Visa">
            <img src="https://www.mastercard.com.tr/content/dam/public/mastercardcom/tr/tr/icons/mc-logo-52.svg" alt="Mastercard">
            <img src="https://vikwp.com/images/plugins/stripe.png" alt="Stripe" style="height: 30px;">
            <img src="https://www.paypalobjects.com/webstatic/mktg/logo/pp_cc_mark_37x23.jpg" alt="PayPal" style="height: 30px;">
        </div>
    </div>
    
    <!-- FAQ Section -->
    <div class="mt-5">
        <h4 class="mb-4 text-center">Sık Sorulan Sorular</h4>
        
        <div class="accordion" id="faqAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                        Aboneliğimi nasıl iptal edebilirim?
                    </button>
                </h2>
                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Aboneliğinizi istediğiniz zaman hesap ayarlarınız üzerinden veya iletişim sayfasından bize ulaşarak iptal edebilirsiniz. İptal işlemi anında gerçekleşir, ancak ödemiş olduğunuz dönem sonuna kadar hizmetlerimizden yararlanmaya devam edersiniz.
                    </div>
                </div>
            </div>
            
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                        Ödeme bilgilerim güvende mi?
                    </button>
                </h2>
                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Kesinlikle! Ödeme işlemleri için endüstri standardı güvenlik protokollerini kullanan Stripe altyapısını kullanıyoruz. Kredi kartı bilgileriniz bizim sunucularımızda saklanmaz ve tüm işlemler SSL şifreleme ile korunur.
                    </div>
                </div>
            </div>
            
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                        Planlar arasında geçiş yapabilir miyim?
                    </button>
                </h2>
                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Evet, istediğiniz zaman planlar arasında geçiş yapabilirsiniz. Daha yüksek bir plana geçiş yaptığınızda fiyat farkı orantılı olarak hesaplanır. Daha düşük bir plana geçiş yapmak isterseniz, mevcut planınızın süresi dolana kadar bekleyebilir veya hemen geçiş yaparak kalan süreyi kaybedebilirsiniz.
                    </div>
                </div>
            </div>
            
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                        Aile planında paylaşım nasıl yapılıyor?
                    </button>
                </h2>
                <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Aile planı ile hesabınıza 5 farklı kullanıcı ekleyebilirsiniz. Her kullanıcı kendi şifresi ile giriş yapabilir ve tahlillerini ayrı ayrı yönetebilir. Hesap yöneticisi olarak siz, tüm kullanıcıları ve tahlilleri görüntüleyebilirsiniz.
                    </div>
                </div>
            </div>
            
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
                        Para iade politikanız nedir?
                    </button>
                </h2>
                <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body">
                        Satın alma işleminizden itibaren 14 gün içinde, herhangi bir neden belirtmeksizin tam iade talep edebilirsiniz. İade talebinizi iletişim sayfamızdan iletebilirsiniz. İade işlemi, ödeme yaptığınız kartın hesabına 3-5 iş günü içerisinde yapılacaktır.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}